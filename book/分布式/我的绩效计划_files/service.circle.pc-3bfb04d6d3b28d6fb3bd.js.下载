(window.webpackJsonp=window.webpackJsonp||[]).push([[155,19],{"+psP":function(e,t,n){n("rB9j"),n("EnZy");var i=n("7xSq");i.directive("processItemMicro",(function(){return{template:n("CY1c"),scope:{objectId:"="},controller:["$scope","$rootScope",function(e,t){e.init=function(){},e.go_item=function(){t.super_go("process",{process_id:e.objectId})}}]}})),i.directive("billItemMicro",(function(){return{template:n("CY1c"),scope:{objectId:"="},controller:["$scope","$rootScope",function(e,t){e.init=function(){},e.go_item=function(){t.super_go("bill",{wf_inst_id:e.objectId})}}]}})),i.directive("workflowBillItemMicro",(function(){return{template:n("CY1c"),scope:{objectId:"=",businessId:"="},controller:["$scope","$rootScope",function(e,t){e.init=function(){var t=e.objectId.split("&");e.wf_inst_id=t[0],e.business_id=t[1]},e.go_item=function(){t.super_go("workflow_bill",{wf_inst_id:e.wf_inst_id,business_id:e.business_id})}}]}})),i.directive("workflowBillItemMicroV3",(function(){return{template:n("CY1c"),scope:{objectId:"=",businessId:"="},controller:["$scope","$rootScope",function(e,t){e.init=function(){var t=e.objectId.split("&");e.wf_inst_id=t[0],e.business_id=t[1]},e.go_item=function(){t.super_go("workflow_bill_v3",{wf_inst_id:e.wf_inst_id,business_id:e.business_id})}}]}}))},"1NbK":function(e,t,n){n("7xSq")},"3eGX":function(e,t,n){n("sMBO");var i=n("M5Mt"),s=n("ZbhI"),o=n("7xSq");n("CAp6"),o.directive("circleGroupSelector",(function(){return{template:n("VToV"),scope:{},controller:["contextService","$scope","$rootScope","circleGroupService","$state","$timeout",function(e,t,n,i,s,o){t.is_select=!1,t.bottom_menu={btn_cancel:{caption:"取消",class:"hcmui-button-normal-fullline",func:function(){t.close()}}},t.begin=function(n){t.option=n,t.is_select=!0,t.search_key="",t.callback=n.callback,i.getNormalGroupList().then((function(e){t.group_data=e,t.$broadcast("search_content_refresh")})),!1===e.getContext("auth").company_setting.IS_CIRCLE_PUBLIC_OPEN?t.public_open=!1:t.public_open=!0,t.public_open&&i.getPublicGroup().then((function(e){t.public_group_data=e}))},t.close=function(){t.option&&t.option.cancel_callback&&t.option.cancel_callback(),t.is_select=!1,o((function(){t.option=null}),500)},t.$on("circle-group-select-event",(function(e,n){t.begin(n)})),t.$watch("search_key",(function(e){t.is_select&&(e&&""!=e?(t._search_timeout&&o.cancel(t._search_timeout),t._search_timeout=o((function(){t.group_search_data=i.searchGroup(e),t.group_search_data.load(null,(function(e){t.$broadcast("search_content_refresh",e)})).then((function(){t.group_search_data.next(!0)}))}),500)):(t.group_search_data=null,t.$broadcast("search_content_refresh",!0)))})),t.group_select=function(e){t.is_select=!1,t.callback({class:"group",data:e})}}]}})),o.directive("groupMemberSelector",(function(){return{template:n("6c64"),scope:{},controller:["contextService","$scope","$rootScope","circleGroupService","$state","$timeout","$filter",function(e,t,n,o,c,a,l){t.is_select=!1,t.auth=e.getContext("auth"),t.bottom_menu={btn_ok:{caption:l("translate")("confirm"),class:"hcmui-button-default-fullline",func:function(){t.submit()}},btn_cancel:{caption:l("translate")("Cancel"),class:"",func:function(){t.close()}}},t.begin=function(e){o.getGroupMembers(e.id).then((function(e){t.member_list=e,t.$broadcast("group_members_list_refresh",!0)})),t.option=e,t.is_select=!0,t.selected=[],t.selected_id=[],t.pre_selected_id=e.pre_selected||[],t.callback=e.callback},t.close=function(){t.option&&t.option.cancel_callback&&t.option.cancel_callback(),t.is_select=!1,a((function(){t.option=null}),500)},t.$on("group-member-select-event",(function(e,n){t.begin(n)})),t.select=function(e){var n,o;if(!(s(n=t.pre_selected_id).call(n,e.id)>-1)){var c,a,l=s(o=t.selected_id).call(o,e.id);if(l>-1)i(c=t.selected).call(c,l,1),i(a=t.selected_id).call(a,l,1);else t.selected.push({id:e.id,name:e.name,photo:e.photo}),t.selected_id.push(e.id)}},t.un_select=function(e){var n,o,c,a=s(n=t.selected_id).call(n,e.id);a>-1&&(i(o=t.selected).call(o,a,1),i(c=t.selected_id).call(c,a,1))},t.submit=function(){t.selected_id.length<1||(t.is_select=!1,t.callback({class:"employee",data:t.selected}))}}]}}))},"4BQy":function(e,t){e.exports='<div class="circle-feed-widget" xmlns="http://www.w3.org/1999/html">\n    <div class="new-content" ng-click="new_article()">\n        <div>分享点好消息....</div>\n    </div>\n    <div class="articles">\n        <div ng-repeat="_item in article_data.list track by $index">\n            <article-item id=\'article_item_{{_item.id}}\'\n                          item="_item">\n            </article-item>\n        </div>\n        <list-next list-controller="article_data"></list-next>\n    </div>\n</div>\n\n'},"5a0P":function(e,t){e.exports='<div ng-init="init()" class="article-item-page full-parent" ng-controller="articleCtrl">\n    <div ng-if="article_enabled">\n        <div class="group-article" ng-if="article_data.feed.biz_id.indexOf(\'group\')>=0">\n            <div class="article-object">\n                <article-item item="article_data" scene="\'single\'">\n                </article-item>\n            </div>\n\n            <div class="article-comments sofa tg"\n                 ng-show="article_comments.list.length<1 && article_data.likes.list.length<1"\n                 ng-click="article_comment()">\n                <div>还没人评论，赶快抢个沙发</div>\n            </div>\n            <div class="article-comments" ng-show="article_comments.list.length>0 || article_data.likes.list.length>0">\n                <div class="likes comment-item" ng-show="article_data.likes.list.length>0">\n                    <span class="icon-hcm-love icon"></span>\n                    <span class="content">&nbsp;\n                    <span ng-repeat="_like in like_list track by _like.id" class="blue tg">&nbsp;{{_like.name}}&nbsp;</span>\n                    </span>\n                    <span class="blue tg" ng-if="!need_extend"\n                          ng-click="extend()">等{{article_data.likes.list.length}}人</span>\n\n                </div>\n                <div ng-repeat="_c in article_comments.list|orderBy :\'date\':desc track by _c.id" class="comment-item tg"\n                     ng-click="comment_click(_c)">\n                    <div class="comment-content">\n                        <span class="comment-name tg">{{_c.logger.name}}</span>\n                        <span ng-if="_c.reply_to.id">\n                        <span class="gray">&nbsp;回复&nbsp;</span>\n                        <span class="comment-name tg">{{_c.reply_to.name}}</span>\n                        </span>\n                        <span class="article-comment" ng-bind-html="_c.comment|toTrusted"></span>\n                        <span class="article-date"> {{_c.date|timeStampToDate|beforeCurrentTime}}</span>\n                    </div>\n                </div>\n                <list-next list-controller="article_comments"></list-next>\n            </div>\n        </div>\n\n        \x3c!-- <div class="resume-card"id=\'article_data.feed.biz_id.match(/d+/)\'></div> --\x3e\n        <div class="recruit-article" ng-if="article_data.feed.biz_id.indexOf(\'recruit\')>=0">\n            <article-resume-card item="article_data" message_id="message_id"></article-resume-card>\n        </div>\n        <div class="recruit-article" ng-if="article_data.feed.biz_id.indexOf(\'perf_goal\')>=0">\n            <article-perf-card item="article_data"></article-perf-card>\n        </div>\n        <div class="recruit-article" ng-if="article_data.feed.biz_id.indexOf(\'perf_card\')>=0">\n            <article-perf-card item="article_data"></article-perf-card>\n        </div>\n    </div>\n    <div ng-if="!article_enabled">\n        <hc-svg options="{icon:\'hcm-no-content\'}" class="no-data-svg"></hc-svg>\n        <div class="no-data-text">该圈子已删除</div>\n    </div>\n</div>\n'},"6H9R":function(e,t){e.exports='<div class=\'vote-feed feed-title\' ng-init="init()" ng-click="go_item()">\n    <div class="icon icon-hcm-vote single-icon tg"></div>\n    <div class="content tg">\n        <div class="title">投票：{{item.name}}</div>\n        <div class="title2">{{item.desc||"没有任何描述"}}</div>\n    </div>\n</div>'},"6c64":function(e,t){e.exports='<div class="employee-selector group-member-selector ng-hide pop-window up" ng-show="is_select" ng-init="init()"\n     ng-cloak>\n    <div ng-show="is_select">\n        <div i-scroll="group_members_list" class="list-person">\n            <div>\n                <div class="list-person-item tg" ng-repeat="_e in member_list"\n                     ng-click="select(_e)" ng-if="_e.id!=auth.employee.id">\n                    <div class="icon">\n                        <img ng-src="{{_e.photo|hcPhoto:64}}">\n                    </div>\n\n                    <div class="content">\n                        <div class="name">{{_e.name}}</div>\n                    </div>\n                    <div class="select-oper"\n                         ng-class="{\'blue icon-hcm-right-circle\':selected_id.indexOf(_e.id)>-1,\'gray icon-hcm-right-circle\':pre_selected_id.indexOf(_e.id)>-1}"></div>\n                </div>\n            </div>\n        </div>\n        <div class="selected-area" ng-show="selected.length>0">\n            <div ng-repeat="_selected in selected" ng-click="un_select(_selected)">\n                <img ng-src="{{_selected.photo|hcPhoto:64}}">\n            </div>\n        </div>\n        <bottom-menu menu="bottom_menu"></bottom-menu>\n    </div>\n\n</div>\n'},"72FG":function(e,t){e.exports='<div class="message-list" data-ng-init="init()" ng-controller="messageListCtrl">\n    <div class="header">\n        <div class="selector">\n            <div ng-class="{selected:curr_type==\'notify\'}" ng-if="message_display==\'notify\'" ng-click="change_type(\'notify\')" class="tg msg-notify">\n                <span>{{msg_notify_tip}}</span>\n                <span class="unread" ng-if="message_status.notify>0 && message_display==\'notify\'">&nbsp;&nbsp;{{message_status.notify}}</span>\n            </div>\n            <div ng-class="{selected:curr_type==\'task\'}" ng-if="message_display==\'notify\'" ng-click="change_type(\'task\')" class="tg msg-task">\n                <span>{{msg_task_tip}}</span>\n                <span class="unread" ng-if="message_status.task>0">&nbsp;&nbsp;{{message_status.task}}</span>\n            </div>\n            <div ng-class="{selected:curr_type==\'task_done\'}" ng-if="message_display==\'notify\'" ng-click="change_type(\'task_done\')" class="tg msg-task-done">{{msg_task_done_tip}}</div>\n            <div ng-class="{selected:curr_type==\'work_warn\'}" ng-if="message_display===\'work_warn\'" ng-click="change_type(\'work_warn\')" class="tg msg-work-warn">{{msg_work_warn_tip}}</div>\n            <div ng-class="{selected:curr_type==\'warn_done\'}" ng-if="message_display===\'work_warn\'" ng-click="change_type(\'warn_done\')" class="tg msg-work-done">{{msg_warn_done_tip}}</div>\n            <div ng-class="{selected:curr_type==\'message_normal_done\'}" ng-if="message_display===\'message_normal\'" ng-click="change_type(\'message_normal_done\')" class="tg msg-message-normal-done">{{msg_message_normal_tip}}</div>\n            <div ng-class="{selected:curr_type==\'message_normal\'}" ng-if="message_display===\'message_normal\'" ng-click="change_type(\'message_normal\')" class="tg msg-message-normal">{{msg_message_normal_done_tip}}</div>\n        </div>\n    </div>\n    <div class="message-search search">\n        <div class="hcm-checkbox" ng-show="curr_type==\'notify\'">\n            <div class="icon"\n                 ng-switch="!!message_selected_items.length&&(message_selected_items.length==message_data.list.length)"\n            >\n                <div class="tag-to-select" ng-class="checkBoxIcon.empty"\n                     ng-switch-when="false"\n                     ng-click="selected_all()">\n                </div>\n                <div class="tag-selected" ng-class="checkBoxIcon.full"\n                     ng-switch-default\n                     ng-click="cancel_all()">\n                </div>\n            </div>\n        </div>\n\n        <div class="search-input">\n            <span class="icon icon-hcm-check"></span>\n            <input id="message-search-input"\n                   ng-change="searchMessage(key_words)"\n                   ng-focus="isCancel(true)"\n                   ng-blur="isCancel(false)"\n                   type="search"\n                   ng-model="key_words"\n                   ng-model-options="{debounce:500}"\n                   placeholder={{msg_message_search}}>\n        </div>\n\n        <div ng-show="client==\'mobile\'&&is_cancel" class="search-cancel" ng-click="searchCancel()">{{msg_message_search_cancel}}</div>\n        <hc-mobile-btn ng-show="curr_type==\'notify\'&&client==\'mobile\'&&!is_cancel"\n                       position="\'header\'"\n                       model="btn_model">\n        </hc-mobile-btn>\n    </div>\n    <div class=\'list\' i-scroll="message_list" ng-class="{notify_list:(client === \'mobile\' && curr_type === \'notify\')}">\n        <div>\n            <div ng-repeat="_item in message_data.list|orderBy:\'send_date\':true track by $index" class="message tg {{_item.message_type}}"\n                 ng-class="{true:\'unread\'}[_item.unread]">\n                <div ng-if="curr_type === \'notify\'" class="btn-cell"\n                     ng-switch="message_selected_items.indexOf(_item)" ng-click="message_selected(_item,$event)">\n                    <div class="tag-to-select icon-hcm-none-rectangle-radius ng-scope"\n                         ng-switch-when="-1"></div>\n                    <div class="tag-selected icon-hcm-click-rectangle-radius-solid"\n                         ng-switch-default></div>\n                </div>\n                <div class="sender-photo">\n                    <img ng-if="_item.from.photo" ng-src="{{(_item.from.photo|hcPhoto:46)}}" alt="sender-photo">\n                    <div ng-if="!_item.from.photo" class="icon icon-activity"></div>\n                </div>\n                <div class="content"\n                     data-ng-click="go_message(_item,true)"\n                     hc-title="{{_item.content|convertFromHtml}}"\n                     options="{seconds: 0, mode: \'tip\'}">\n                    <div class="top_item">\n                        <div class="name">{{_item.from ? _item.from.name : \'HCM Cloud\'}}</div>\n                        <div class="task-done-right-1" hc-title="{{_item.title.tips|convertFromHtml}}">\n                            <div class="task-done-1">{{_item.title.name || \'通知\'}}</div>\n                        </div>\n                    </div>\n                    <div class="btn_item">\n                        <div class="date">&nbsp;{{_item.date|timeStampToDate|beforeCurrentTime}}</div>\n\n                        <div class="text">{{_item.content|convertFromHtml}}</div>\n                    </div>\n\n                </div>\n                <div class="state"\n                     data-ng-click="go_message(_item)"\n                     hc-title={{msg_message_detail}}\n                     options="{seconds: 0, mode: \'tip\'}">\n                    <div class="icon icon-hcm-arrow-right"></div>\n                </div>\n            </div>\n            <list-next list-controller="message_data"></list-next>\n        </div>\n    </div>\n</div>\n'},"7xSq":function(e,t,n){var i=n("KHwQ").module("myApp");e.exports=i},"83+L":function(e,t,n){n("t9FI"),n("+psP")},"9qm4":function(e,t){e.exports='<div class="feed-self-service feed-title">\n    <div class="icon tg">\n        <div class="{{item.icon}}"></div>\n    </div>\n    <div class="content tg">\n        <div class="title">{{item.name}}</div>\n        <div class="title2">{{item.description}}</div>\n    </div>\n</div>'},CAp6:function(e,t,n){n("oVuX"),n("7xSq").factory("circleGroupService",["listCacheService2","dataService","contextService","$q","$state",function(e,t,n,i,s){return{getGroupList:function(){return e({class:"circle_group"},"circle.group.list",{})},getNormalGroupList:function(){return t.callHcmOpenApi("circle.group.normal.list",{},null,!0)},getPublicGroup:function(){return t.callHcmOpenApi("circle.group.public",{},null,!0)},searchGroup:function(t){return e(null,"circle.group.search",{key:t})},getGroup:function(e){return t.callHcmOpenApi("circle.group.get",{group_id:e||""},null,!0)},getGroupByFeed:function(e){return t.callHcmOpenApi("circle.group.get.by.feed",{feed_id:e||""},null,!0)},getGroupMembers:function(e){return t.callHcmOpenApi("feed.get.members",{biz_id:e},null,!0)},invite:function(e,n){return t.callHcmOpenApi("circle.group.invite",{group_id:e,employee_ids:n.join(",")},null,!0)},createGroup:function(e){return t.callHcmOpenApi("circle.group.create",{group_name:e},null,!0)},quitGroup:function(e){return t.callHcmOpenApi("circle.group.quit",{group_id:e||"",except:[80002]},null,!0)},removeFromGroup:function(e,n){return t.callHcmOpenApi("circle.group.quit",{group_id:e||"",employee_id:n,except:[80002]},null,!0)},closeGroup:function(e){return t.callHcmOpenApi("circle.group.close",{group_id:e||"",except:[80002]},null,!0)},modifyGroup:function(e,n){return t.callHcmOpenApi("circle.group.modify",{group_id:e,group_name:n},null,!0)},getGroupUnread:function(){return t.callHcmOpenApi("circle.group.unread",{},null,!0)}}}])},CY1c:function(e,t){e.exports='<div class=\'process-micro\' ng-init="init()" ng-click="go_item()">\n    <div class="process-icon icon-hcm-vote"></div>\n    <div class="process-micro-content">\n        <div class="process-micro-name">审批流程</div>\n        <div class="process-micro-desc">审批流程</div>\n    </div>\n</div>'},"F+Zn":function(e,t){e.exports='<div data-ng-init="init()" ng-controller="messageCtrl" class="message-viewer">\n    <div class="header">\n        <div class="photo">\n            <img ng-src="{{message.from?(message.from.photo|hcPhoto:36):(\'hcmcloud\'|hcImage:46)}}">\n        </div>\n        <div>\n            <div class="name">{{message.from?message.from.name:\'HCM Cloud\'}}</div>\n        </div>\n        <div class="date">\n            <div>{{message.date|timeStampToDate|beforeCurrentTime}}</div>\n        </div>\n    </div>\n    <div class="content">\n        <span ng-bind-html="message.content|toTrusted"></span><br>\n    </div>\n    <div class="message-attachments">\n        <div class="message-attachment" ng-repeat="att in attachments" ng-if="show_attachment">\n            <div class="att-name" ng-click="viewAttachment(att.index, att.att_type)">{{att.name}}</div>\n            <div class="content-box">\n                <div class="icon icon-hcm-download" hc-title={{msg_file_down_load}} ng-if="client == \'pc\'"\n                     ng-click="downloadAttachment(att.index)"></div>\n                <div class="icon icon-hcm-download" hc-title={{msg_file_down_load}} ng-if="client == \'mobile\'"\n                     ng-click="downloadAttachment(att.index)"></div>\n            </div>\n        </div>\n        <div class="file-content" ng-show="!show_attachment">\n            {{msg_file_miss}}\n        </div>\n    </div>\n    <div class="message-state" >\n        <div  ng-if="client ==\'mobile\'">\n            <div class="left-sight" ng-if="message.go_state !== \'message\'" ng-click="go_state()">{{msg_go_state}}</div>\n            <div class="btn icon-hcm-link" ng-if="message.go_state !== \'message\'" ng-click="go_state()"></div>\n            \x3c!--            <div class="right-sight icon-hcm-copy"  ng-click="copy()"></div>--\x3e\n\n        </div>\n        <div ng-if="client == \'pc\'">\n            <div class="left-sight"  ng-if="message.go_state !== \'message\'" ng-click="go_state()">{{msg_go_state}}</div>\n            <div class="btn icon-hcm-link"  ng-if="message.go_state !== \'message\'" ng-click="go_state()"></div>\n            \x3c!--            <div class="right-sight icon-hcm-copy"  ng-click="copy()"></div>--\x3e\n        </div>\n\n    </div>\n    <div class="mobile-bottom-style" ng-if="client==\'mobile\'">\n        <div class="bottom-bar-menu-item icon-hcm-arrow-left" ng-click="go_back()"></div>\n        <div class="bottom-bar-menu-item right icon-hcm-copy"  ng-click="content_copy()"></div>\n    </div>\n\n</div>\n'},"G+n7":function(e,t,n){"use strict";n.r(t);n("pNMO"),n("4Brf"),n("sMBO"),n("07d7"),n("JfAA");var i=n("7xSq");n.n(i).a.directive("feedGroup",(function(){return{template:n("Kg9C"),scope:{objectId:"=",bizType:"="},controller:["$scope","$rootScope","$hcDialog","contextService","$state","$timeout","circleGroupService",function(e,t,n,i,s,o,c){c.getGroup(e.objectId).then((function(t){e.data=t})),e.operate_group=function(){1==e.data.group_type?t.super_go("group_prop",{group_prop_id:e.data.id}):2==e.data.group_type&&n.confirm("您确认要关闭私人圈子吗？",[{caption:"确认关闭",func:function(){c.closeGroup(e.data.id).then((function(){t.show_warning("关闭成功！"),t.super_go("threads",{refresh:!0},{location:"replace"})}),(function(e){t.show_warning(e.description,"warning")}))}}])},e.go_feed=function(){t.super_go("feed",{biz_id:"group:"+e.data.id.toString()})}}]}})).directive("miniFeedGroup",(function(){return{template:n("fHcx"),scope:{objectId:"=",bizType:"="},controller:["$scope","$rootScope","contextService","$state","$timeout","circleGroupService",function(e,t,n,i,s,o){o.getGroup(e.objectId).then((function(t){e.data=t,e.feed_name=2==e.data.group_type?"我和"+e.data.name+"的私人群组":e.data.name})),e.go_feed=function(){t.super_go("feed",{biz_id:"group:"+e.data.id.toString()})}}]}})).directive("feedVote",(function(){return{template:n("6H9R"),scope:{objectId:"="},controller:["contextService","$scope","$rootScope","voteService","$state","$timeout","multiPageService",function(e,t,n,i,s,o,c){t.init=function(){i.getVote(t.objectId).then((function(e){t.item=e}))},t.go_item=function(){n.super_go("vote",{id:t.item.id})}}]}})).directive("miniFeedVote",(function(){return{template:n("TIPd"),scope:{objectId:"="},controller:["contextService","$scope","$rootScope","voteService","$state","$timeout","multiPageService",function(e,t,n,i,s,o,c){t.init=function(){i.getVote(t.objectId).then((function(e){t.item=e}))},t.go_item=function(){n.super_go("vote",{id:t.item.id})}}]}})).directive("feedSelfservice",(function(){return{template:n("9qm4"),scope:{objectId:"="},controller:["contextService","$scope","$rootScope","selfServiceConfigureService","$state","$timeout","multiPageService",function(e,t,n,i,s,o,c){i.get_service(t.objectId).then((function(e){t.item=e}))}]}})).directive("miniFeedSelfservice",(function(){return{template:n("sA1a"),scope:{objectId:"="},controller:["contextService","$scope","$rootScope","selfServiceConfigureService","$state","$timeout","multiPageService",function(e,t,n,i,s,o,c){i.get_service(t.objectId).then((function(e){t.item=e}))}]}}))},GutA:function(e,t,n){n("yShA")},IZVi:function(e,t){e.exports='<div class="group-create" ng-controller="groupCreateCtrl">\n    <div class="title">请输入小组名称</div>\n    <div class="title2">数据表明：群组名称影响群组活跃度</div>\n\n    <div class="name">\n        <input ng-model="group_name" placeholder="请输入小组名称...">\n    </div>\n    <div class="oper">\n        <div class="oper-ok" ng-click="submit()">{{is_creating?\'创建中...\':\'确认\'}}</div>\n    </div>\n</div>'},IkEK:function(e,t,n){"use strict";n.r(t);n("oVuX"),n("rB9j"),n("UxlC");var i=n("M5Mt"),s=n.n(i),o=n("FLGM"),c=n.n(o),a=n("7xSq"),l=n.n(a);n("1NbK"),n("CAp6"),n("CHk/"),l.a.directive("articleComment",(function(){return{template:n("smUh"),scope:{},controller:["$filter","circleGroupService","contextService","$scope","$rootScope","commentService","$state","$timeout","$hcListBtn",function(e,t,n,i,o,a,l,r,_){i.start_to_employee_select=function(){var e,t;i.group&&2==i.group.group_type||(i.group&&1==i.group.group_type?i.$emit("group-member-select",{id:i.article.feed.biz_id,selected:c()(t=i.comment_at).call(t,(function(e){return e.id})),callback:function(e){i.comment_at=e.data}}):i.$emit("employee-select",{selected:c()(e=i.comment_at).call(e,(function(e){return e.id})),callback:function(e){i.comment_at=e.data}}))},i.init=function(){var e=[{key:"cancel",label:"取消",func:i.close_comment},{key:"submit",label:"发送",is_important:!0,func:i.submit_comment,disabled:function(){return i.is_commenting||i.content_length_overflow}}];i.list_btn_model=_.createListBtn().$setMeta(e)},i.$on("article-comment-event",(function(e,n){i.is_comment=!0,i.article=n.article,t.getGroupByFeed(i.article.feed_id).then((function(e){i.group=e})),i.reply=n.reply,i.comment_text="",i.comment_at=[],i.callback=n.callback,r((function(){$(".article-comment .comment-input").focus()}),500)})),i.un_at_employee=function(e){var t;s()(t=i.comment_at).call(t,e,1)},i.content_length=0,i.content_change=function(){i.content_length=i.comment_text.replace(/\r\n/g,"<BR>").replace(/\n/g,"<BR>").length,i.content_length_overflow=i.content_length>150},i.close_comment=function(){i.is_comment=!1},i.submit_comment=function(){var e;i.is_commenting||i.content_length_overflow||(i.is_commenting=!0,a.createComment({article_id:i.article.id,reply_to_id:i.reply?i.reply.id+":"+i.reply.obj_type:"",comment:i.comment_text.replace(/\r\n/g,"<BR>").replace(/\n/g,"<BR>"),at_employee_ids:c()(e=i.comment_at).call(e,(function(e){return e.id})).join(",")}).then((function(e){i.is_commenting=!1,i.is_comment=!1,r((function(){$(".article-comment .comment-input").blur()}),300),i.callback(e)})))}}]}}))},Kg9C:function(e,t){e.exports='<div class="feed-group feed-title">\n    <div class="icon tg">\n        <div class="group-photo company" ng-if="data.group_type==0">\n            <div class="icon-homepage"></div>\n        </div>\n\n        <div class="group-photo" ng-class="{\'private\':data.group_type==2}" ng-if="data.group_type!=0">\n            <img ng-repeat="_p in data.members_photo  track by $index"\n                 ng-src="{{_p|hcPhoto:46}}">\n        </div>\n    </div>\n    <div class="content tg">\n        <div class="title">{{data.name}}</div>\n        <div class="title2">\n            <span ng-if="data.group_type==1">成员：{{data.members}}&nbsp;&nbsp;</span>\n            <span>消息：{{data.feed.articles==100?\'99+\':data.feed.articles}}</span>\n        </div>\n    </div>\n    <div class="go tg" ng-click="operate_group()" ng-show="data.group_type==1||data.group_type==2">\n        <div ng-class="{\'icon-hcm-community\':data.group_type==1,\'icon-hcm-trash\':data.group_type==2}"></div>\n    </div>\n</div>\n'},MJJY:function(e,t,n){n("7xSq").factory("circleFeedService",["listCacheService2","dataService","paramMix",function(e,t,n){return{getFeed:function(e,i){return t.callHcmOpenApi("circle.feed.get",{biz_id:n.encryption(e),biz_name:i||""},null,!0)},feedArticles:function(t){return e({biz_id:t,class:"feed_article"},"circle.group.feed.articles",{biz_id:t})}}}])},NJ8p:function(e,t,n){n("rB9j"),n("EnZy");var i=n("7xSq");n("MJJY"),i.directive("feedIcon",(function(){return{template:n("s99Z"),scope:{bizId:"=",bizName:"="},controller:["$scope","$rootScope","contextService","$state","$timeout","circleFeedService",function(e,t,n,i,s,o){e.init=function(){e.load()},e.$watch("bizId",(function(t){t&&e.load()})),e.$watch("bizName",(function(t){t&&e.load()})),e.load=function(){e.bizId&&e.bizName&&!e.loaded&&(e.loaded=!0,o.getFeed(e.bizId,e.bizName).then((function(t){e.feed=t})))},e.show_feed=function(){t.super_go("feed",{biz_id:e.bizId,view:"articles"})}}]}})),i.directive("feed",(function(){return{template:n("4BQy"),scope:{bizId:"="},controller:["$http","$q","$scope","$rootScope","contextService","$state","$timeout","circleFeedService",function(e,t,n,i,s,o,c,a){n.loadData=function(){n.bizId=n.bizId||"",n.article_data=a.feedArticles(n.bizId),n.article_data.load((function(){n.set_refreshing&&n.set_refreshing(!0)}),(function(e){n.set_refreshing&&n.set_refreshing(!1),n.$emit("feed_data_changed",e)})).then((function(){n.article_data.next(!0)}))},n.loadData(),n.$on("article_reload",(function(){n.loadData()})),n.new_article=function(){n.$emit("article-new",{to_biz:n.bizId,callback:function(){n.article_data.next(!0)}})},n.go_article=function(e){i.super_go("article",{id:e})},n.$on("feed_reload",(function(e,t){n.article_data.next(!0).then(t)})),n.$on("feed_new_article",(function(e,t){n.new_article()}))}]}})).directive("feedBizObject",["$compile",function(e){return{restrict:"EA",replace:!0,template:"<div>{{item}}</div>",scope:{bizId:"="},link:function(t,n,i){t.object_id=t.bizId.split(":")[1];var s="<feed-"+t.bizId.split(":")[0];s+=" object-id='object_id'></feed-"+t.bizId.split(":")[0]+">",n.html(s),e(n.contents())(t)}}}])},NXfS:function(e,t,n){n("sMBO"),n("rB9j"),n("EnZy");var i=n("UtpJ"),s=n("ZbhI"),o=n("FLGM");n("7xSq").controller("articleCtrl",["$hcDialog","$filter","weChatService","messageService","commentService","contextService","cacheService","articleService","$timeout","$scope","$rootScope","$state","$location","dataService",function(e,t,n,c,a,l,r,_,d,p,m,g,u,f){p.is_loading=!0,p.need_extend=!0,p.message_id=g.params.message_id,p.article_comments=a.getCommentList(g.params.id),m.recent_article=g.params.id,p.init=function(){p.loadData()},p.loadData=function(){_.getArticle(g.params.id).then((function(e){var c,a;(p.article_enabled=e.enabled,e.type=e.feed.biz_id.split(":")[0],o(c=e.attachments).call(c,(function(t){var n;e.feed.biz_state=s(n=t.attachment_class).call(n,"interview")?"evaluate":""})),p.article_data=e,p.article_data.other_comment=p.article_comments,p.article_comments.load((function(){}),(function(){})).then((function(){p.article_comments.next(!0)})),p.article_data.likes.list.length>30)?(p.need_extend=!1,p.like_list=i(a=p.article_data.likes.list).call(a,0,30)):p.like_list=p.article_data.likes.list;n.setShareOption(p.article_data.owner.name+":"+p.article_data.content,p.article_data.content,null,p.article_data.images.length>0?t("hcImage")(p.article_data.images[0],"200,200"):null)}))},p.$on("article_reload",(function(){p.loadData()})),p.$on("article_comment_refresh",(function(){p.article_comments.next(!0)})),p.delete_comment=function(t){e.confirm("是否确认要删除评论？",[{caption:"删除评论",func:function(){a.deleteComment(t).then((function(e){p.article_comments.next(!0)}))}}])},p.article_comment=function(e){p.$emit("article-comment",{article:p.article_data,reply:e,callback:function(e){p.article_comments.next(!0)}})},p.comment_click=function(e){e.is_owner?p.delete_comment(e.id):p.article_comment(e.logger)},p.go_emp=function(e,t){t&&t.stopPropagation(),m.super_go("emp",{id:e})},p.extend=function(){p.need_extend=!p.need_extend,p.like_list=p.article_data.likes.list}}])},P8iB:function(e,t){e.exports='<div ng-init="init()" ng-click="showLocation()" class="fieldwork-widgets-container">\n    <div class="icon">\n        <img ng-if="fieldwork_item.timezone==\'Asia/Shanghai\'" ng-src="http://restapi.amap.com/v3/staticmap?location={{fieldwork_item.longitude}},{{fieldwork_item.latitude}}&zoom=10&size=100*100&markers=small,0x03a9f4,:{{fieldwork_item.longitude}},{{fieldwork_item.latitude}}&key=ee95e52bf08006f63fd29bcfbcf21df0">\n        \x3c!-- <img ng-if="fieldwork_item.timezone!=\'Asia/Shanghai\'" ng-src="https://api.map.baidu.com/staticimage/v2?width=300&height=260&zoom=18&scale=2&center={{fieldwork_item.longitude}},{{fieldwork_item.latitude}}&markers={{fieldwork_item.longitude}},{{fieldwork_item.latitude}}&markerStyles=l,o,0xff0000&ak=D7KG4CoeclWrYbUGU7dMCGfS9Uhn0YFz"> --\x3e\n    </div>\n    <div class="fieldwork-widgets-content">\n        <div class="fieldwork-widgets-address">{{fieldwork_item.address}}</div>\n        <div>\n            <span ng-if="!!empName" class="fieldwork-widgets-employee">\n                {{empName}}\n            </span>\n            <span class="fieldwork-widgets-time">\n                <span ng-if="fieldwork_item.local_datetime==null">{{fieldwork_item.datetime||beforeCurrentTime}}</span>\n                <span ng-if="fieldwork_item.local_datetime!=null">{{fieldwork_item.local_datetime||beforeCurrentTime}}</span>\n                <span ng-if="fieldwork_item.timezone!=\'Asia/Shanghai\'"> (当地时间) </span>\n            </span>\n        </div>\n    </div>\n</div>\n'},TIPd:function(e,t){e.exports='<span class=\'vote-feed\' ng-init="init()" ng-click="go_item()">\n    投票：{{item.name}}\n</span>'},"U+XH":function(e,t,n){n("NcmB")},U5sc:function(e,t){e.exports='<div class="mainBox message_title" ng-init="init()">\n    <div class="top"\n         ng-show="!(message_type ==\'img_message\' || message_type ==\'pdf_message\' || message_type ==\'system_img\'||message_type ==\'high_level_message\')">\n        <div class="title">{{title}}</div>\n        <div class="time">{{time}}</div>\n    </div>\n    \x3c!--    判断类型--\x3e\n    <div class=\'message\' ng-show="message_type==\'pdf_message\'">\n        <div id="printAppointDismissal"></div>\n    </div>\n    <div class=\'message\' ng-show="message_type==\'high_level_message\'">\n        <hc-mark-down class="markdown"\n                      ng-if="message"\n                      ng-model="message"\n                      options="{mode:\'view\'}"\n        ></hc-mark-down>\n\n        <div  ng-repeat="att in go_param.photo_file_index track by $index">\n            <img ng-src="/img?type=image&index={{att}}">\n        </div>\n        <div>\n            <div style="float: left" ng-show="show_file_preview">\n                <hc-input-upload-multiple class="multi-image"\n                                          options="multi_image_data_preview.options"\n                                          ng-model="file_list_str_preview"\n                ></hc-input-upload-multiple>\n            </div>\n            <div style="float: left" ng-show="show_file">\n                <hc-input-upload-multiple class="multi-image"\n                                          options="multi_image_data.options"\n                                          ng-model="file_list_str"\n                ></hc-input-upload-multiple>\n            </div>\n        </div>\n    </div>\n    <div class=\'message\' ng-show="message_type==\'system_img\'">\n        <img src="/document/loadsourceimage?index={{go_param.file_index}}">\n    </div>\n    <div class="message"\n         ng-show="!(message_type ==\'img_message\' || message_type ==\'pdf_message\' || message_type ==\'system_img\'||message_type ==\'high_level_message\')">{{message}}</div>\n</div>\n'},VToV:function(e,t){e.exports='\n<div class="employee-selector ng-hide pop-window up" ng-show="is_select" ng-init="init()" ng-cloak>\n    <div ng-show="is_select">\n        <div class="search-box">\n            <div class="input">\n                <input placeholder="搜索：您的圈子" type="search" autocapitalize="off"\n                       autocorrect="off"\n                       autocomplete="off"\n                       spellcheck="false" ng-model="search_key">\n            </div>\n        </div>\n        <div class="search-content" i-scroll="search_content">\n            <div>\n                <div class="group-selector"\n                     ng-show="search_key==\'\'">\n                    <div class="group-selector-item company tg" ng-click="group_select(public_group_data)" ng-show="public_open">\n                        <div class="group-photo company">\n                            <div class="icon-homepage"></div>\n                        </div>\n\n                        <div class="content">\n                            公司大厅\n                        </div>\n                        <div class="select-oper blue icon-hcm-right-circle"\n                             ng-show="selected_group.id==public_group_data"></div>\n                    </div>\n                    <div ng-repeat="_c in group_data" class="group-selector-item tg"\n                         ng-click="group_select(_c)">\n                        <div class="group-photo">\n                            <img ng-repeat="_p in _c.members_photo track by $index" ng-src="{{_p|hcPhoto:46}}">\n                        </div>\n                        <div class="content">\n                            {{_c.name}}\n                        </div>\n                        <div class="select-oper blue icon-hcm-right-circle" ng-show="selected_group.id==_c.id"></div>\n                    </div>\n                </div>\n                <div class="search-result list-person" ng-show="search_key!=\'\'">\n                    <div ng-repeat="_c in group_search_data.list" class="group-selector-item tg"\n                         ng-click="group_select(_c)">\n                        <div class="group-photo">\n                            <img ng-repeat="_p in _c.members_photo track by $index" ng-src="{{_p|hcPhoto:46}}">\n                        </div>\n                        <div class="content">\n                            {{_c.name}}\n                            <span class="desc"></span>\n                        </div>\n                        <div class="select-oper blue icon-hcm-right-circle"\n                             ng-show="selected_group.id==_c.id"></div>\n                    </div>\n                    <list-next list-controller="group_search_data"></list-next>\n                </div>\n            </div>\n        </div>\n        <bottom-menu menu="bottom_menu"></bottom-menu>\n    </div>\n</div>'},WoLE:function(e,t,n){"use strict";n.r(t);var i=n("7xSq");n.n(i).a.directive("articleListItem",(function(){return{restrict:"E",scope:{object:"="},template:n("whPt"),controller:["$scope","$rootScope",function(e,t){e.go_article=function(){t.super_go("article",{id:e.object.id})}}]}})).controller("articleTopCtrl",["contextService","$filter","commentService","$scope","$rootScope","articleService","$hcDialog","$timeout",function(e,t,n,i,s,o,c,a){i.init=function(){i.$dialog.operates([]),s.show_waiting(),o.getArticleSendMemberCount(i.params.id).then((function(e){e.success&&(i.member_count=e.count,s.hide_waiting())}))},i.close=function(){i.$dialog.dialog_close()},i.submit=function(){i.$dialog.resolve_data(!0),i.$dialog.dialog_close()}}])},Wu39:function(e,t,n){"use strict";n.r(t);n("rB9j"),n("Rm1S"),n("UxlC"),n("EnZy");var i=n("LYCE"),s=n.n(i),o=n("HnXd"),c=n.n(o),a=n("qjzJ"),l=n.n(a),r=n("RXMP"),_=n.n(r),d=n("fHi0"),p=n.n(d),m=n("5PDf"),g=n.n(m),u=n("OWCx"),f=n.n(u),v=n("+oHS"),h=n.n(v),w=n("lHQ6"),b=n.n(w),$=n("MAKL"),y=n.n($),k=n("FLGM"),x=n.n(k),C=n("M5Mt"),S=n.n(C),M=n("ZbhI"),D=n.n(M),I=n("04Ix"),O=n.n(I),E=n("526F"),P=n.n(E),A=n("mnMc"),j=n.n(A),z=n("3xDC"),L=n.n(z),B=n("yZ58"),H=n.n(B),G=n("8Auy"),T=n("1hbj"),R=n("bQov"),q=n("mJ0u"),U=n("mshF"),F=n("vl5y");function N(e,t){var n=h()(e);if(f.a){var i=f()(e);t&&(i=g()(i).call(i,(function(t){return p()(e,t).enumerable}))),n.push.apply(n,i)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n,i=null!=arguments[t]?arguments[t]:{};if(t%2)_()(n=N(Object(i),!0)).call(n,(function(t){O()(e,t,i[t])}));else if(l.a)c()(e,l()(i));else{var o;_()(o=N(Object(i))).call(o,(function(t){s()(e,t,p()(i,t))}))}}return e}n("7xSq").controller("messageListCtrl",["messageService","contextService","cacheService","articleService","$timeout","$scope","$rootScope","$state","$location","dataService","$q","$hcListBtn","$hcDialog","$filter",function(e,t,i,s,o,c,a,l,r,_,d,p,m,g){c.staticImageHCMCloud=n("tZg7"),c.curr_type=l.params.type||"notify",c.message_display=l.params.message_display||"notify",c.auth=t.getContext("auth"),c.key_words=null,c.change_type=function(e){c.curr_type=e,c.key_words=null,c.init()},c.checkBoxIcon={empty:"icon-hcm-none-rectangle-radius",full:"icon-hcm-click-rectangle-radius-solid"},c.init=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;c.msg_task_tip=g("translate")("msg_task_tip"),c.msg_notify_tip=g("translate")("msg_notify_tip"),c.msg_task_done_tip=g("translate")("msg_task_done_tip"),c.msg_work_warn_tip=g("translate")("msg_work_warn_tip"),c.msg_warn_done_tip=g("translate")("msg_warn_done_tip"),c.msg_message_normal_tip=g("translate")("msg_message_normal_tip"),c.msg_message_normal_done_tip=g("translate")("msg_message_normal_done_tip"),c.msg_message_search=g("translate")("msg_message_search"),c.msg_message_search_cancel=g("translate")("msg_message_search_cancel"),c.msg_message_detail=g("translate")("msg_message_detail"),c.message_oder=l.params.message_sort_oder,c.is_cancel=!1,"work_warn"!==c.message_display?c.message_data=e.messageList(c.curr_type,n):c.message_data=e.warnMessageList(c.curr_type,20,t.getContext("auth").employee.id),c.message_data.load((function(){c.set_refreshing(!0)}),(function(e){c.$emit("message_list_refresh",e),c.set_refreshing(!1)})).then((function(){var e;"asc"===c.message_oder&&L()(e=c.message_data.list).call(e);c.message_data.next(!0)})),e.getMessageStatus().then((function(e){c.message_status=e})),c.message_selected_items=[],c.client=window.client,"task"!==c.curr_type&&"task_done"!==c.curr_type||(c.btn_model=p.createListBtn().$setMeta([{key:"del",label:"删除",enable:!0,hide:!0,disabled:function(){return 0===c.message_selected_items.length},func:c.delete}]),"pc"===window.client&&c.set_bottom_menu([{name:"刷新",index:1,align:"left",enable:!0,icon:"icon-hcm-refresh",func:function(){a.show_waiting(1),c.message_data.next(!0),a.hide_waiting(1)}},{name:"删除",index:2,align:"left",hide:!0,enable:!0,icon:"icon-hcm-trash",func:c.delete}])),"notify"===c.curr_type&&(c.btn_model=p.createListBtn().$setMeta([{key:"del",label:"删除",enable:!0,hide:!1,disabled:function(){return 0===c.message_selected_items.length},func:c.delete},{label:"全部已读",index:1,align:"left",enable:!0,key:"set_read",func:c.set_message_read}]),"pc"===window.client&&c.set_bottom_menu([{name:"刷新",index:1,align:"left",enable:!0,icon:"icon-hcm-refresh",func:function(){a.show_waiting(1),c.message_data.next(!0),a.hide_waiting(1)}},{name:"设置全部通知已读",index:1,align:"left",enable:!0,icon:"icon-hcm-click-rectangle-radius",func:c.set_message_read},{name:"删除",index:2,align:"left",hide:!1,enable:!0,icon:"icon-hcm-trash",func:c.delete}]))},c.set_refresh((function(){c.message_data.next(!0)})),c.showHighLevelMessage=function(e){e.list[0].go_param.title?m.getDialog(F.default).size("large").title(e.list[0].go_param.title).params(e).show():m.getDialog(F.default).size("large").params(e).show()},c.go_message=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n||t.is_read||e.getMessage(t.id).then((function(e){})),n?"high_level_message"===t.message_type?c.showHighLevelMessage({list:[t]}):c.goState(t):a.super_go("message",{id:t.id})},c.goState=function(t){var n,i;if(c.curr_type&&"task"===c.curr_type&&c.$emit("side-bar-close",!0),t.go_state&&""!==t.go_state&&"action"!==t.go_state)if(e.getMessage(t.id).then((function(e){})),j()(n=["workflow_bill_v3","workflow_bill","bill"]).call(n,t.go_state))c.$emit("side-bar-close",!0),_.callHcmOpenApi("workflow.business.version",{business_id:t.go_param.business_id}).then((function(e){if(e.success){var n=3===e.version?"WorkflowDetailNewInfoCtrl":"WorkflowDetailInfoCtrl";1===e.version&&(n="billDialog");U.a.getCustomDialogCtrl(n).then((function(n){m.getDialog(1===e.version?n:n(t.go_param.business_id)).params(P()({mode:"view",source_entry:t.is_task_done?2!=t.is_task_done?"message_pending":"message_approved":"message_notify"},t.go_param)).size("full").show().then((function(e){e||a.show_warning(g("translate")("wf_approve_err"),"warning")}))}))}}));else if(j()(i=["signin.punchin","time_punch"]).call(i,t.go_state)&&"mobile"!==window.client)a.show_warning("请在移动端进行打卡！");else if("messagerouter"===t.go_state)t.go_url?window.open(t.go_url):a.show_warning("消息类别错误,无法查看!");else if("show_robot"===t.go_state){c.$emit("side-bar-close",!0);var s=t.go_param;U.a.getCustomDialogCtrl("HCMChatDialog").then((function(e){m.getDialog(e).show(K({target:"HCMRobot"},s))}))}else if("show_comm_task_dialog"===t.go_state){if("pc"===c.client)return c.$emit("side-bar-close",!0),U.a.getCustomDialogCtrl("HCMChatTaskDialog").then((function(e){return m.getDialog(e).size("super-max").show({instance_id:t.go_param.instance_id,target:t.go_param.target,sender:t.go_param.sender,meta_state:t.go_param.meta_state,alter_data:t.go_param.alter_data})}));a.super_go("message",{id:t.id})}else{var o,l=(null===(o=t.go_param)||void 0===o?void 0:o.is_vue)||!1;a.super_go(t.go_state,t.go_param,{inherit:!1,is_vue:l})}else a.super_go("message",{id:t.id})},c.message_selected=function(e,t){var n;t&&t.stopPropagation();var i,s=D()(n=c.message_selected_items).call(n,e);~s?S()(i=c.message_selected_items).call(i,s,1):c.message_selected_items.push(e)},c.selected_all=function(){var e;c.message_selected_items=[],c.message_data&&x()(e=c.message_data.list).call(e,(function(e){c.message_selected_items.push(e)}))},c.cancel_all=function(){c.message_selected_items=[]},c.delete=function(){var t;0===c.message_selected_items.length&&m.confirm("是否清除所有通知消息?").then((function(){e.messageBatchDelete().then((function(e){e.success?c.init(c.key_words):a.show_warning("删除失败，请联系管理员")}))}));var n=x()(t=c.message_selected_items).call(t,(function(e){return e.id}));e.messageDelete(n).then((function(e){e.success?c.init(c.key_words):a.show_warning("删除失败，请联系管理员")}))},c.set_message_read=function(){m.confirm("是否设置全部消息已读,确认后将刷新页面?").then((function(){e.messageBatchSetRead().then((function(e){e.success?window.location.reload():a.show_warning("设置失败，请联系管理员排查")}))}))},c.searchMessage=function(t){c.key_words=t,c.message_data=e.messageList(c.curr_type,t),c.message_data.load((function(){c.set_refreshing(!0)}),(function(e){c.$emit("message_list_refresh",e),c.set_refreshing(!1)})).then((function(){c.message_data.next(!0)}))},c.isCancel=function(e){c.is_cancel=e},c.searchCancel=function(){c.key_words&&c.searchMessage(),c.key_words=null}}]).controller("messageState",["messageService","$timeout","$scope","$rootScope","$state","$hcDialog",function(e,t,n,i,s,o){n.message_id=s.params.message_id||n.params.message_id,e.getMessage(n.message_id).then((function(e){if(e.go_state)if("action"===e.go_state)n.funcParse(e.go_param).action();else if(e.go_state&&"messagerouter"===e.go_state)e.go_url?window.open(e.go_url):i.show_warning("消息类别错误,无法跳转!");else if("show_robot"===e.go_state){var t=e.go_param;U.a.getCustomDialogCtrl("HCMChatDialog").then((function(e){o.getDialog(e).show(K({target:"HCMRobot"},t))}))}else if("show_comm_task_dialog"===e.go_state){if("pc"===n.client)return U.a.getCustomDialogCtrl("HCMChatTaskDialog").then((function(t){return o.getDialog(t).size("super-max").show({instance_id:e.go_param.instance_id,target:e.go_param.target,sender:e.go_param.sender,meta_state:e.go_param.meta_state,alter_data:e.go_param.alter_data})}));i.super_go("message",{id:e.id})}else{var s,c=(null===(s=e.go_param)||void 0===s?void 0:s.is_vue)||!1;i.super_go(e.go_state,e.go_param,{location:"replace",is_vue:c})}else i.super_go("message",{id:e.id})})),n.funcParse=function(e){var t={$hcDialog:o,CommonModelViewDialog:q.a,CommonModelInfoDialog:T.a,CommonInfoDialog:T.a,CommonModelListDialog:R.a,WINDOW:window};return G.a.jsonEval(e,t,{})}}]).controller("messageCtrl",["documentPreviewService","messageService","contextService","cacheService","articleService","$timeout","$scope","$rootScope","$state","$location","$hcDialog","$filter",function(e,t,n,i,s,o,c,a,l,r,_,d){c.is_message_loading=!0,c.client=window.client,c.message_id=l.params.id||l.params.message_id||c.param.id,c.show_attachment=!0,c.msg_file_down_load=d("translate")("msg_file_down_load"),c.msg_file_miss=d("translate")("msg_file_miss"),c.msg_go_state=d("translate")("msg_go_state"),c.msg_content_copy=d("translate")("msg_content_copy"),t.getMessage(c.message_id).then((function(t){c.is_message_loading=!1,c.message=t,c.message.content=c.message.content.replace(/\r\n/g,"").replace(/\n/g,"");var i=/\[attachment\:([^\[\]]+)\,([^\[\]]+)\]/g;if(c.attachments=c.message.content.match(i),c.attachments){var s,o,a,l,r;c.attachments=x()(s=c.attachments).call(s,(function(e){var t=(e=e.replace("[attachment:","").replace("]","").split(","))[1].split(".")[e.length-1];return{index:e[0],name:e[1],att_type:t}}));var _=null===(o=n.getContext("auth"))||void 0===o||null===(a=o.company_setting)||void 0===a?void 0:a.sys_temp_file_save_days;(null===(l=n.getContext("auth"))||void 0===l||null===(r=l.company_setting)||void 0===r?void 0:r.sys_temp_file_control_open)&&_&&c.message.date&&y()()-c.message.date>=24*b()(_)*3600*1e3&&(c.show_attachment=!1)}c.message.content=c.message.content.replace(i,""),c.viewAttachment=function(t,n){var i;~D()(i=["zip","xlsx"]).call(i,n)?c.downloadAttachment(t):(e.preViewDocument(t),c.close_circle_side_bar())},c.downloadAttachment=function(e){window.open(window.hcm_wengen+"/document/loadsourcedocument/"+e+window.hcm_env_pre)}})),c.content_copy=function(){var e=document.createElement("input");e.value=c.message.content,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),a.show_warning(c.msg_content_copy)},c.go_back=function(){if(n.getContext("auth").company_setting.show_new_portal)window.history.back(-1);else{window.history;r.url("/messages")}},"pc"===c.client&&(c.tmp_history=angular.copy(c.history),c.set_bottom_menu&&c.set_bottom_menu([{name:"复制",index:1,align:"right",enable:!0,hide:!1,icon:"icon-hcm-copy",func:c.content_copy}]),c.set_history&&c.set_history(c.tmp_history)),c.go_state=function(){var e;if("action"===c.message.go_state)c.$emit("side-bar-close",!0),c.funcParse(c.message.go_param).action();else if(c.message.go_state&&"messagerouter"===c.message.go_state)c.message.go_url?window.open(c.message.go_url):a.show_warning("消息类别错误,无法跳转!"),c.close_circle_side_bar();else if("show_robot"===c.message.go_state){var t=c.message.go_param;U.a.getCustomDialogCtrl("HCMChatDialog").then((function(e){_.getDialog(e).show(K({target:"HCMRobot"},t))})),c.close_circle_side_bar()}else if("show_comm_task_dialog"===c.message.go_state){if("pc"===c.client)return c.close_circle_side_bar(),U.a.getCustomDialogCtrl("HCMChatTaskDialog").then((function(e){return _.getDialog(e).size("super-max").show({instance_id:c.message.go_param.instance_id,target:c.message.go_param.target,sender:c.message.go_param.sender,meta_state:c.message.go_param.meta_state,alter_data:c.message.go_param.alter_data})}));a.super_go("message",{id:c.message.id})}else if(j()(e=["signin.punchin","time_punch"]).call(e,c.message.go_state))a.show_warning("请在移动端进行打卡！");else{var n,i=(null===(n=c.message.go_param)||void 0===n?void 0:n.is_vue)||!1;a.super_go(c.message.go_state,c.message.go_param,{location:"replace",is_vue:i}),c.close_circle_side_bar()}},c.funcParse=function(e){var t={$hcDialog:_,CommonModelViewDialog:q.a,CommonModelInfoDialog:T.a,CommonInfoDialog:T.a,CommonModelListDialog:R.a,WINDOW:window};return G.a.jsonEval(e,t,{})}}]),t.default={controller:"messageCtrl",template:H.a,title:"消息查看"}},"X/IB":function(e,t){e.exports='<div class="thread-list full-parent" data-ng-init="init()" ng-controller="circleThreadCtrl" i-scroll="circle_thread">\n    <div>\n        <div class="group tg" ng-click="go_group(public_thread.id)" ng-if="public_open">\n            <div class="photo">\n                <div class="group-photo company">\n                    <div class="icon-homepage"></div>\n                </div>\n                <div class="unread" ng-show="public_thread.unread"></div>\n            </div>\n            <div class="content" ng-show="public_open">\n                <div class="date">&nbsp;{{public_thread.feed.operate_ts|timeStampToDate|beforeCurrentTime}}\n                </div>\n                <div class="name">公司大厅</div>\n                <div class="text">\n                    {{(public_thread.feed.last_article||\'暂时还没有消息\')|convertFromHtml}}&nbsp;\n                </div>\n            </div>\n        </div>\n        <div ng-repeat="_item in thread_data.list track by $index" class="group tg"\n             ng-click="go_group(_item.id)" id=\'thread_{{_item.id}}\'>\n            <div class="photo">\n                <div class="group-photo" ng-class="{\'private\':_item.group_type==2}">\n                    <img ng-repeat="_p in _item.members_photo  track by $index"\n                         ng-src="{{_p|hcPhoto:42}}">\n                </div>\n                <div class="unread" ng-show="_item.unread"></div>\n            </div>\n            <div class="content">\n                <div>\n                    <div class="date">{{_item.feed.operate_ts|timeStampToDate|beforeCurrentTime}}</div>\n                    <div class="name">{{_item.name}}</div>\n                </div>\n                <div>\n                    <div class="text">\n                        {{_item.feed.last_article?_item.feed.last_article:\'暂时没有消息\'|convertFromHtml}}\n                    </div>\n                </div>\n            </div>\n        </div>\n        <list-next list-controller="thread_data"></list-next>\n    </div>\n</div>\n'},Yy7j:function(e,t,n){n("7xSq")},aITb:function(e,t,n){var i=n("KHwQ").module("myApp");e.exports=i},fHcx:function(e,t){e.exports='<span class="feed-group" ng-click="go_feed()">{{feed_name}}</span>'},gbtD:function(e,t,n){n("pNMO"),n("4Brf"),n("oVuX"),n("sMBO"),n("07d7"),n("JfAA");var i=n("UtpJ"),s=n("5PDf"),o=n("WxoT"),c=n("FLGM");n("7xSq").controller("groupPropCtrl",["circleGroupService","contextService","cacheService","articleService","$timeout","$scope","$rootScope","$state","$hcDialog","dataService","$q",function(e,t,n,i,s,o,a,l,r,_,d){o.auth=t.getContext("auth"),t.getContext("auth").company_setting.IS_CIRCLE_PAUSE&&a.super_go("circle_closed",{},{location:"replace"}),o.init=function(){t.getContext("auth").company_setting.IS_CIRCLE_PAUSE&&a.super_go("circle_closed",{},{location:"replace"}),e.getGroup(l.params.group_prop_id).then((function(e){o.group=e})),e.getGroupMembers(l.params.group_prop_id).then((function(e){o.group_members=e,o.$broadcast("group_prop_refresh")}))},o.submit=function(){""!=o.group_name?o.group_name.length>50?a.show_warning("标题长度不要超过50字符"):(o.is_modifying=!0,e.modifyGroup(l.params.group_prop_id,o.group_name).then((function(e){o.is_modifying=!1,a.show_warning("修改成功!"),"pc"==window.client?o.back():window.history.back()}))):a.show_warning("您还没输入名字哦!")},o.member_add=function(){var t;o.is_adding||o.$emit("employee-select",{show_group:!1,pre_selected:c(t=o.group_members).call(t,(function(e){return e.id})),callback:function(t){var n,i=a.show_warning("邀请中，请稍候...",null,0);o.set_refreshing(!0),o.is_adding=!0,e.invite(l.params.group_prop_id,c(n=t.data).call(n,(function(e){return e.id}))).then((function(e){o.is_adding=!1,i.set_content("邀请成功！"),o.set_refreshing(!1),o.group_members=e,o.$broadcast("group_prop_refresh")}))}})},o.begin_name_modify=function(){o.group_name=o.group.name,o.is_name_modify=!0},o.cancel_name_modify=function(){o.is_name_modify=!1},o.submit_name_modify=function(){e.modifyGroup(l.params.group_prop_id,o.group_name).then((function(e){o.group=e,o.is_name_modify=!1}))},o.go_group=function(){a.super_go("feed",{biz_id:"group:"+o.group.id.toString()},{location:"replace"})},o.go_emp=function(e){a.super_go("emp",{id:e})},o.remove_from_group=function(t,n){t&&t.stopPropagation(),r.confirm("您确认要移除该成员吗？",[{caption:"确认移除",func:function(){e.removeFromGroup(o.group.id,n).then((function(){a.show_warning("移除成功！"),a.super_go("threads",{},{location:"replace"})}),(function(e){a.show_warning(e.description,"warning")}))}}])},o.quit_group=function(){o.auth.employee.id==o.group.owner_id?r.confirm("您确认要关闭该圈子吗？",[{caption:"确认关闭",func:function(){e.closeGroup(o.group.id).then((function(){a.show_warning("关闭成功！"),a.super_go("threads",{refresh:!0},{location:"replace"})}),(function(e){a.show_warning(e.description,"warning")}))}}]):r.confirm("您确认要退出该小组吗？",[{caption:"确认退出",func:function(){e.quitGroup(o.group.id).then((function(){a.show_warning("退出成功！"),a.super_go("threads",{},{location:"replace"})}),(function(e){a.show_warning(e.description,"warning")}))}}])}}]).controller("groupCreateCtrl",["circleGroupService","contextService","cacheService","articleService","$timeout","$scope","$rootScope","$state","$location","dataService","$q",function(e,t,n,i,s,o,c,a,l,r,_){o.init=function(){t.getContext("auth").company_setting.IS_CIRCLE_PAUSE&&c.super_go("circle_closed",{},{location:"replace"}),e.getGroup(a.params.group_prop_id).then((function(e){o.group=e}))},o.submit=function(){""!=(o.group_name||"")?o.is_creating||(o.group_name.length>50?c.show_warning("标题长度不要超过50字符"):(o.is_creating=!0,e.createGroup(o.group_name).then((function(e){o.is_creating=!1,c.super_go("group_prop",{group_prop_id:e.id},{location:"replace"})})))):c.show_warning("您还没输入名字哦!")}}]).controller("circleThreadCtrl",["circleGroupService","circleFeedService","contextService","cacheService","$timeout","$scope","$rootScope","$state","$location","dataService","multiPageService","$http",function(e,t,n,a,l,r,_,d,p,m,g,u){n.getContext("auth").company_setting.IS_CIRCLE_PAUSE&&_.super_go("circle_closed",{},{location:"replace"}),r.page_director=_.page_forward,r.thread_data=e.getGroupList(),r.auth=n.getContext("auth"),"pc"==window.client&&r.set_bottom_menu([{name:"add",index:2,icon:"icon-hcm-add",align:"left",enable:!0,func:function(){_.super_go("group_create",{})}}]),r.init=function(){n.getContext("auth").company_setting.IS_CIRCLE_PAUSE&&_.super_go("circle_closed",{},{location:"replace"}),!1===n.getContext("auth").company_setting.IS_CIRCLE_PUBLIC_OPEN?r.public_open=!1:r.public_open=!0;var t=window.sessionStorage.getItem("public_thread");r.public_thread=t?JSON.parse(t):null,r.thread_data.load((function(){r.set_refreshing(!0)}),(function(e){r.set_refreshing(!1),r.$broadcast("circle_thread_refresh",e)})).then((function(t){_.is_super_go("threads")||d.params.refresh||!t||!t.length?r.refresh_thread_list():(r.$broadcast("circle_thread_restore_position"),_.recent_group&&e.getGroup(_.recent_group).then((function(e){0==e.group_type?(r.public_thread=e,window.sessionStorage.setItem("public_thread",o(e))):(r.thread_data.update(_.recent_group,e),_.recent_group=null)})))}))},r.refresh_thread_list=function(){r.thread_data.next(!0),e.getPublicGroup().then((function(e){r.public_thread=e,window.sessionStorage.setItem("public_thread",o(e))}))},r.set_refresh((function(){r.refresh_thread_list()})),r.go_group=function(e){_.recent_group=e,_.super_go("feed",{biz_id:"group:"+e})},r.get_name=function(e){var t,n,o;return e.name?e.name:1==e.members.count&&e.members.list[0].id==r.auth.employee.id?r.auth.employee.name+"的私密空间":c(t=s(n=i(o=e.members.list).call(o,0,3)).call(n,(function(e){return e.id!=r.auth.employee.id}))).call(t,(function(e){return e.name})).join("，")+(e.members.count>4?"等":"")}}]).controller("circleClosedCtrl",["circleGroupService","contextService","cacheService","articleService","$timeout","$scope","$rootScope","$state","$location","dataService","$q",function(e,t,n,i,s,o,c,a,l,r,_){o.init=function(){}}])},geKc:function(e,t,n){n("rB9j"),n("EnZy"),n("7xSq").controller("circleFeedController",["circleFeedService","articleService","circleGroupService","contextService","cacheService","$timeout","$scope","$rootScope","$state","$location","dataService","multiPageService","$http",function(e,t,n,i,s,o,c,a,l,r,_,d,p){i.getContext("auth").company_setting.IS_CIRCLE_PAUSE&&a.super_go("circle_closed",{},{location:"replace"}),c.biz_id=l.params.biz_id,c.init=function(){i.getContext("auth").company_setting.IS_CIRCLE_PAUSE&&a.super_go("circle_closed",{},{location:"replace"}),"group"==c.biz_id.split(":")[0]&&(c.set_refreshing(!0),n.getGroup(c.biz_id.split(":")[1]).then((function(e){c.group_prop=e,c.set_refreshing(!1)}))),c.set_refreshing(!0),e.getFeed(c.biz_id).then((function(e){c.feed_prop=e,c.set_refreshing(!1)})),c.loadData()},c.loadData=function(){c.article_data=e.feedArticles(c.biz_id),c.article_data.load((function(){c.set_refreshing&&c.set_refreshing(!0)}),(function(e){c.set_refreshing&&c.set_refreshing(!1),c.$emit("circle_feed_refresh",e)})).then((function(e){a.is_super_go("feed",{biz_id:l.params.biz_id})||!e?c.article_data.next(!0):(c.$broadcast("circle_feed_restore_position"),a.recent_article&&t.getArticle(a.recent_article).then((function(e){c.article_data.update(a.recent_article,e),a.recent_article=null})))}))},c.$on("article_reload",(function(){c.loadData()})),c.refresh_feed=function(){"group"==c.biz_id.split(":")[0]&&(c.set_refreshing(!0),n.getGroup(c.biz_id.split(":")[1]).then((function(e){c.group_prop=e,c.set_refreshing(!1)}))),c.set_refreshing(!0),e.getFeed(c.biz_id).then((function(e){c.feed_prop=e,c.set_refreshing(!1)})),c.article_data.next(!0)},c.set_refresh(c.refresh_feed),c.new_article=function(){c.$emit("article-new",{to_biz:c.biz_id,callback:function(){c.refresh_feed()}})},c.go_article=function(e){a.recent_article=e,a.super_go("article",{id:e})}}])},iXcy:function(e,t){e.exports='<div ng-init="init()" class="punchin-widgets-container" ng-click="showRanking()">\n    <div class="icon">{{punchin_item.ranking}}</div>\n    <div class="punchin-widgets-content">\n        <div>\n            <span class="punchin-widgets-time">\n                {{punchin_item.time|dateFormat:"hh:mm:ss"}}\n            </span>\n            在\n            <span class="punchin-widgets-address">\n                {{punchin_item.address}}\n            </span>\n            使用了移动打卡,\n            打卡排名\n            <span class="punchin-widgets-ranking">\n                {{punchin_item.ranking}}\n            </span>\n        </div>\n    </div>\n</div>'},rBbT:function(e,t){e.exports='<div class="group-prop full-parent" ng-controller="groupPropCtrl" ng-init="init()" i-scroll="group_prop">\n    <div>\n        <div class="group-property">\n            <div class="tg" ng-click="begin_name_modify()">\n                <span class="title">圈子名称</span>\n                <span class="context">{{group.name}}</span>\n                <span class="go icon-hcm-arrow-right"></span>\n            </div>\n            <div class="tg">\n                <span class="title">创建者</span>\n                <span class="context">{{group.owner.name}}</span>\n            </div>\n        </div>\n\n        <div class="group-members">\n            <div ng-repeat="_m in group_members" class="group-member tg" ng-click="go_emp(_m.id)">\n                <span class="delete icon icon-hcm-delete-circle" ng-click="remove_from_group($event,_m.id)" ng-if="_m.id!=group.owner_id"></span>\n                <img ng-src="{{_m.photo|hcPhoto:46}}">\n                <div class="member-name">{{_m.name}}</div>\n            </div>\n            <div class="group-member tg" ng-click="member_add()">\n                <div class="member-add icon-hcm-add"></div>\n                <div class="member-name"></div>\n            </div>\n        </div>\n        <div class="operate">\n            <span class="oper-quit tg" ng-click="quit_group()">{{auth.employee.id==group.owner_id?\'关闭圈子\':\'退出圈子\'}}</span>\n            <span class="oper-go hcmui-button-default" ng-click="go_group()">进入圈子</span>\n        </div>\n    </div>\n\n    <div class="group-name-modify pop-window" ng-show="is_name_modify">\n        <div ng-show="is_name_modify">\n            <div class="frame">\n                <div class="title">修改圈子名称</div>\n                <div class="title2">数据表明：圈子名称影响圈子活跃度</div>\n\n                <div class="name">\n                    <input ng-model="group_name" placeholder="请输入圈子名称...">\n                </div>\n                <div class="oper">\n                    <div class="oper-ok tg" ng-click="submit_name_modify()">确认</div>\n                    <div class="oper-un tg" ng-click="cancel_name_modify()">取消</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},s99Z:function(e,t){e.exports='<div ng-init="init()" class="feed-icon" ng-click="show_feed(bizId)">\n    <span ng-show="feed.articles>0">{{feed.articles==100?\'99+\':feed.articles}}&nbsp;评</span>\n    <span ng-hide="feed.articles>0">评论</span>\n</div>\n'},sA1a:function(e,t){e.exports='<span class="feed-self-service">\n    {{item.name}}\n</span>'},smUh:function(e,t){e.exports='<div class="article-comment-box ng-hide pop-window" ng-show="is_comment" ng-init="init()" ng-cloak>\n    <div class="article-comment ng-hide" ng-show="is_comment">\n        <div class="header">\n            <div class="header-title">\n                <span ng-show="reply!=null">回复&nbsp;{{reply.name}}</span>\n                <span ng-hide="reply!=null">评论</span>\n            </div>\n            <div class=\'oper tg\'>{{is_commenting ? \'发送中\' : \'\'}}</div>\n        </div>\n        <div class="comment-operate">\n            <div ng-click="start_to_employee_select()">\n                <span class="icon icon-hcm-at" ng-class="{disabled:group.group_type==2}"></span>\n            </div>\n        </div>\n        <div class="input">\n                <textarea class=\'comment-input\' contentEditable class=\'f15\'\n                          placeholder="说点什么吧..."\n                          ng-model="comment_text" ng-change="content_change()"></textarea>\n\n            <div class="content-length" ng-class="{\'overflow\':content_length_overflow}">{{content_length}}/150</div>\n        </div>\n        <div class="comment-at" ng-show="comment_at.length>0">\n            <div ng-repeat="_emp in comment_at" class="tg" ng-click="un_at_employee(_emp)">\n                {{_emp.name}}\n            </div>\n        </div>\n\n\n        <footer>\n            <hc-list-btn model="list_btn_model"></hc-list-btn>\n        </footer>\n    </div>\n</div>\n'},t9FI:function(e,t,n){var i=n("D3kx");n("7xSq").directive("attendFieldworkMicro",(function(){return{restrict:"E",scope:{objectId:"=",objectData:"=",empName:"="},template:n("P8iB"),controller:["$scope","$filter","weChatService",function(e,t,n){e.init=function(){e.fieldwork_item={},e.objectData&&("string"==typeof e.objectData?e.fieldwork_item=JSON.parse(e.objectData):e.fieldwork_item=e.objectData,e.showLocation=function(){if("pc"!=window.client){var t={latitude:i(e.fieldwork_item.latitude),longitude:i(e.fieldwork_item.longitude),name:e.fieldwork_item.datetime,address:e.fieldwork_item.address,scale:28,infoUrl:""};n.showLocation(t)}})}}]}})).directive("attendPunchinMicro",(function(){return{restrict:"E",scope:{objectId:"=",objectData:"="},template:n("iXcy"),controller:["$scope","$filter","$rootScope",function(e,t,n){e.init=function(){e.punchin_item=JSON.parse(e.objectData||"{}")},e.showRanking=function(){n.super_go("punchin_ranking",{period:t("dateFormat")(e.punchin_item.time,"yyyy-MM-dd")})}}]}})).directive("attendPunchinv3Micro",(function(){return{restrict:"E",scope:{objectId:"=",objectData:"="},template:n("iXcy"),controller:["$scope","$filter","$rootScope",function(e,t,n){e.init=function(){e.punchin_item=JSON.parse(e.objectData||"{}")},e.showRanking=function(){n.super_go("punchin_rankingv3",{period:t("dateFormat")(e.punchin_item.time,"yyyy-MM-dd")})}}]}}))},uFCZ:function(e,t){e.exports='<div ng-controller="circleFeedController" ng-init="init()" class="circle-feed full-parent" i-scroll="circle_feed">\n    <div>\n        <div class="feed-object">\n            <feed-biz-object biz-id="biz_id"></feed-biz-object>\n        </div>\n        <div class="feed-content">\n            <div class="new-content" ng-click="new_article()">\n                <div>分享点好消息....</div>\n            </div>\n            <div class="articles">\n                <div ng-repeat="_item in article_data.list track by $index">\n                    <article-item id=\'article_item_{{_item.id}}\'\n                                  item="_item">\n                    </article-item>\n                </div>\n                <list-next list-controller="article_data"></list-next>\n            </div>\n        </div>\n    </div>\n</div>'},v6AK:function(e,t,n){n("7xSq").factory("messageService",["listCacheService","listCacheService2","dataService","$q",function(e,t,n,i){return{getMessageUnread:function(){return n.callHcmOpenApi("message.unread.count",{except:"10001"},null,!0)},getMessageStatus:function(){return n.callHcmOpenApi("message.status",{},null,!0)},getMessage:function(e){return n.callHcmOpenApi("message.get",{id:e},null,!0)},messageList:function(e,n){return t({class:"message_list",type:e},"message.list",{type:e,key_words:n})},messageHighLevelList:function(e){return n.callHcmOpenApi("message.list",{level:e,ch_read:!1})},warnMessageList:function(e,n,i){var s=1;return"warn_done"===e&&(s=2),t(null,"get.warn.message.list",{page_size:n,to:i,status:s})},messageSetRead:function(e){return n.callHcmOpenApi("message.set.read",{id:e},null,!0)},messageDelete:function(e){return n.callHcmOpenApi("message.batch.delete",{ids:e})},messageBatchSetRead:function(){return n.callHcmOpenApi("batch.set.message.read",{})},messageBatchDelete:function(){return n.callHcmOpenApi("batch.remove.notify",{})}}}])},vl5y:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("pNMO"),core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("4Brf"),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_corejs3_core_js_stable_instance_index_of__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("ZbhI"),_babel_runtime_corejs3_core_js_stable_instance_index_of__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_corejs3_core_js_stable_instance_index_of__WEBPACK_IMPORTED_MODULE_2__),_showMessage_html__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("U5sc"),_showMessage_html__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_showMessage_html__WEBPACK_IMPORTED_MODULE_3__),_showMessage_scss__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("L6CN"),_showMessage_scss__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_showMessage_scss__WEBPACK_IMPORTED_MODULE_4__),moment__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("wd/R"),moment__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_5__),PDFObject=__webpack_require__("JcNw");window.app.controller("showMessageController",["$controller","$scope","dataService","documentPreviewService",function($controller,$scope,dataService,documentPreviewService){if($scope.readed=function(e){(0==$scope.now||$scope.now>$scope.sended)&&dataService.callHcmOpenApi("message.set.read ",{id:e}).then((function(){$scope.sended=$scope.now}))},$scope.changeStatus=function(e){switch(e){case 1:return function(){return!$scope.ifOldCanClick};case 2:return function(){return!$scope.ifNewCanClick}}},$scope.resetOperate=function(){$scope.$dialog.operates([{key:333,label:"上一条",hide:!$scope.ifOldCanClick,func:function func(){if($scope.ifNewCanClick=!0,$scope.now-1>=0){if($scope.now=$scope.now-1,$scope.title=$scope.params.list[$scope.now].title.description,$scope.time=moment__WEBPACK_IMPORTED_MODULE_5___default()($scope.params.list[$scope.now].send_date).format("YYYY-MM-DD HH:mm:ss"),$scope.message=$scope.params.list[$scope.now].content,$scope.message_type=$scope.params.list[$scope.now].message_type,$scope.go_param=$scope.params.list[$scope.now].go_param,$scope.ifOldCanClick=!0,$scope.go_param=eval($scope.go_param),$scope.file_list_str="",$scope.file_list_str_preview="",$scope.go_param&&$scope.go_param.download_file_index&&$scope.go_param.download_file_type&&$scope.go_param.download_file_index.length===$scope.go_param.download_file_type.length)for(var i=0;i<$scope.go_param.download_file_index.length;i++){var _context;-1===_babel_runtime_corejs3_core_js_stable_instance_index_of__WEBPACK_IMPORTED_MODULE_2___default()(_context=["xls","xlsx","png","jpg","jpeg","pdf"]).call(_context,$scope.go_param.download_file_type[i])?""===$scope.file_list_str?$scope.file_list_str=$scope.go_param.download_file_index[i]:$scope.file_list_str=$scope.file_list_str+"#"+$scope.go_param.download_file_index[i]:""===$scope.file_list_str_preview?$scope.file_list_str_preview=$scope.go_param.download_file_index[i]:$scope.file_list_str_preview=$scope.file_list_str_preview+"#"+$scope.go_param.download_file_index[i]}$scope.show_file=0!==$scope.file_list_str.length,$scope.show_file_preview=0!==$scope.file_list_str_preview.length,0==$scope.now&&($scope.ifOldCanClick=!1)}else $scope.ifOldCanClick=!1;$scope.resetOperate()},default:!1,disabled:$scope.changeStatus(1)},{key:999,label:"下一条",hide:!$scope.ifNewCanClick,func:function func(){if($scope.ifOldCanClick=!0,$scope.now+1<$scope.params.count){if($scope.now=$scope.now+1,$scope.title=$scope.params.list[$scope.now].title.description,$scope.time=moment__WEBPACK_IMPORTED_MODULE_5___default()($scope.params.list[$scope.now].send_date).format("YYYY-MM-DD HH:mm:ss"),$scope.message=$scope.params.list[$scope.now].content,$scope.message_type=$scope.params.list[$scope.now].message_type,$scope.go_param=$scope.params.list[$scope.now].go_param,$scope.ifNewCanClick=!0,$scope.go_param=eval($scope.go_param),$scope.file_list_str="",$scope.file_list_str_preview="",$scope.go_param&&$scope.go_param.download_file_index&&$scope.go_param.download_file_type&&$scope.go_param.download_file_index.length===$scope.go_param.download_file_type.length)for(var i=0;i<$scope.go_param.download_file_index.length;i++){var _context2;-1===_babel_runtime_corejs3_core_js_stable_instance_index_of__WEBPACK_IMPORTED_MODULE_2___default()(_context2=["xls","xlsx","png","jpg","jpeg","pdf"]).call(_context2,$scope.go_param.download_file_type[i])?""===$scope.file_list_str?$scope.file_list_str=$scope.go_param.download_file_index[i]:$scope.file_list_str=$scope.file_list_str+"#"+$scope.go_param.download_file_index[i]:""===$scope.file_list_str_preview?$scope.file_list_str_preview=$scope.go_param.download_file_index[i]:$scope.file_list_str_preview=$scope.file_list_str_preview+"#"+$scope.go_param.download_file_index[i]}$scope.show_file=0!==$scope.file_list_str.length,$scope.show_file_preview=0!==$scope.file_list_str_preview.length,$scope.now==$scope.params.list.length-1&&($scope.ifNewCanClick=!1),$scope.readed($scope.params.list[$scope.now].id)}else $scope.ifNewCanClick=!1;$scope.resetOperate()},default:!0,disabled:$scope.changeStatus(2)},{key:123,label:"确认",func:function(){var e;null===(e=$scope.$dialog)||void 0===e||e.dialog_close()},hide:function(){return!window.app}}])},$scope.title=$scope.params.list[0].title.description,$scope.time=moment__WEBPACK_IMPORTED_MODULE_5___default()($scope.params.list[0].send_date).format("YYYY-MM-DD HH:mm:ss"),$scope.message=$scope.params.list[0].content,$scope.message_type=$scope.params.list[0].message_type,$scope.go_param=eval($scope.params.list[0].go_param),$scope.file_list_str="",$scope.file_list_str_preview="",$scope.go_param&&$scope.go_param.download_file_index&&$scope.go_param.download_file_type&&$scope.go_param.download_file_index.length===$scope.go_param.download_file_type.length)for(var i=0;i<$scope.go_param.download_file_index.length;i++){var _context3;-1===_babel_runtime_corejs3_core_js_stable_instance_index_of__WEBPACK_IMPORTED_MODULE_2___default()(_context3=["xls","xlsx","png","jpg","jpeg","pdf"]).call(_context3,$scope.go_param.download_file_type[i])?""===$scope.file_list_str?$scope.file_list_str=$scope.go_param.download_file_index[i]:$scope.file_list_str=$scope.file_list_str+"#"+$scope.go_param.download_file_index[i]:""===$scope.file_list_str_preview?$scope.file_list_str_preview=$scope.go_param.download_file_index[i]:$scope.file_list_str_preview=$scope.file_list_str_preview+"#"+$scope.go_param.download_file_index[i]}if($scope.show_file=0!==$scope.file_list_str.length,$scope.show_file_preview=0!==$scope.file_list_str_preview.length,$scope.multi_image_data_preview={options:{readOnly:!0,not_download:!1,not_preview:!1,hide_name:!1}},$scope.multi_image_data={options:{readOnly:!0,not_download:!1,not_preview:!0,hide_name:!1}},$scope.now=0,$scope.sended=0,$scope.ifOldCanClick=!1,$scope.ifNewCanClick=!0,$scope.readed($scope.params.list[$scope.now].id),$scope.params.count>1?$scope.ifNewCanClick=!0:$scope.ifNewCanClick=!1,$scope.resetOperate(),$scope.$dialog.setClose((function(){$scope.$dialog.resolve_data(),$scope.$dialog.dialog_close()})),"pc"===$scope.client){var file_name=$scope.params.list[0].go_param.file_name;PDFObject.embed(window.location.protocol+"//"+window.location.host+window.hcm_wengen+"/document/get_pdf_by_index/".concat(file_name,"?temp=use&index=")+$scope.go_param.file_index+window.hcm_env_post,"#printAppointDismissal")}}]),__webpack_exports__.default={controller:"showMessageController",template:_showMessage_html__WEBPACK_IMPORTED_MODULE_3___default.a,title:"重要消息预览",name:"showMessageDialog"}},whPt:function(e,t){e.exports='<div class=\'article-list-item tg\' ng-hide="object.enabled!=1" ng-click="go_article()">\n    <div class="header">\n        <div class="name">\n            <span class="owner tg" ng-click="go_emp(object.owner.id)">{{object.owner.name}}</span>\n            <div class="to tg">\n                <div class="to-arrow">\n                    <svg viewBox="0 0 48 48" height="100%" width="100%">\n                        <path d="M20 14l10 10-10 10z"></path>\n                    </svg>\n                </div>\n                <feed-biz-object-mini biz-id="object.feed.biz_id"></feed-biz-object-mini>\n            </div>\n        </div>\n        <div class="date">\n            <div>{{object.date|timeStampToDate|beforeCurrentTime}}</div>\n        </div>\n    </div>\n    <div class="content">\n        <span ng-bind-html="object.content|toTrusted"></span>\n    </div>\n</div>\n'},xBEa:function(e,t){e.exports='<div id="circle-closed-page" class="full-parent" data-ng-init="init()" ng-controller="circleClosedCtrl">\n    <div class="circle-building-icon icon-hcm-attention"></div>\n    <div class="circle-building">圈子功能正在维护中, 敬请期待...</div>\n</div>\n'},yShA:function(e,t,n){n("oVuX"),n("07d7"),n("JfAA"),n("aITb").factory("voteService",["listCacheService2","dataService",function(e,t){return{getVoteList:function(t){return e(null,"vote.list",{type:t})},getVoteToDo:function(){return t.callHcmOpenApi("vote.todo",{},null,!0)},voteIt:function(e,n){return t.callHcmOpenApi("vote.it",{vote_id:e.toString(),choice_id:n.toString()},null,!0)},getVoteLog:function(e){return t.callHcmOpenApi("vote.log",{id:e},null,!0)},voteInvite:function(e,n){return t.callHcmOpenApi("vote.invite",{id:e,ids:n?n.join(","):""},null,!0)},voteCreate:function(e){return t.callHcmOpenApi("vote.create",e,null,!0)},getVote:function(e){return t.callHcmOpenApi("vote.get",{id:e},null,!0)}}}])}}]);